<h1>Using recent rainfall figures to predict Newtown Creek sewer overflows</h1>

<h2>Goal</h2>

<p>We want to predict whether a sewer will overflow soon based on current
rainfall data in order to make <a href="http://dontflush.me">DontFlush.me</a>&rsquo;s alerts
more relevant.</p>

<h2>Data sources</h2>

<h3>Overflow statistic</h3>

<p>We received a book from a FOIA request. This book contains graphs of, among
other things, sewer overflow incidents in New York City during the top 10
storms of 2011 for each of the 14 sewage treatment plants.</p>

<blockquote><p>Dates of the top ten storms, in the order they are presented in the book</p>

<ul>
<li>8/14/2011</li>
<li>8/27/2011</li>
<li>9/6/2011</li>
<li>3/6/2011</li>
<li>4/16/2011</li>
<li>11/22/2011</li>
<li>10/29/2011</li>
<li>9/23/2011</li>
<li>5/17/2011</li>
<li>12/7/2011</li>
</ul>
</blockquote>

<p>For each of these 10 storms, the graphs present a 48-hour or 60-hour window
of data around the storm. For 60-hour widows, we only used the first 48-hours.
This results in a total of 7720 observation-hours, with one observation per
hour.</p>

<p><img src="2012-12-07.jpg" alt="Sewer activity plot from December 7, 2012" /></p>

<h3>Rainfall statistic</h3>

<p>We collected rainfall statistics from Weather Underground. We chose this
because of the [practical applications blah blah]</p>

<h2>Methods</h2>

<h3>Data collection</h3>

<p>We focused on the Newtown Creek sewershed. We have 480 observation-hours
(10 storms at 14 plants) in the book. We measured overflow as hours between
an NC throttle start (solid diamond) and an NC throttle end (empty diamond),
inclusive. For example, the two darkened bands on this plot, from hours t1
to t2, indicate overflow periods.</p>

<p><img src="2012-12-07-annotated.jpg" alt="Sewer activity plot from December 7, 2012 with shaded regions representing overflow periods as explained in the above paragraph" /></p>

<p>The MPS throttle start (solid circle) and end (empty circle) apparently
indicates overflows coming from the Manhattan pump station, which gets sent
through the Newtown Creek station. We ignored these overflows.</p>

<p>For each of these hours, we also acquired the most recent observation from
Weather Underground. This resulted in a table that looked like this.</p>

<pre><code>Date  Hour After 9 am  Overflowing?  Last rainfall figure
----  ---- ----------  ------------  --------------------
           No          Yes
</code></pre>

<p>To account for the diurnal flow, we added an &ldquo;after 9 am&rdquo; variable, which was
&ldquo;no&rdquo; for midnight to 9 am and &ldquo;yes&rdquo; for 10 am on.</p>

<pre><code>Date  Hour After 9 am  Overflowing?  Last rainfall figure
----  ---- ----------  ------------  --------------------
           No          Yes
</code></pre>

<h3>Model</h3>

<p>We used the following model (in R formula syntax).</p>

<pre><code>overflowing ~ Last rainfall figure + after 9 am
</code></pre>

<p>We also made some plot</p>

<p>blah blah</p>

<p>Figure out
* that weird spike of falses
* 100 records lost in the join
* what family of distribution should the rainfall follow theoretically</p>

<p>Add the pictures.
Verify the paper API data by connecting frank&rsquo;s, tom&rsquo;s and casey&rsquo;s.</p>

<h2>Conclusions</h2>

<p>2 mm is a decent cut-off for the guess</p>

<p><img src="threshold.identification.png" alt="This is a plot of stacked dots with one dot per observation hour, precipitation rate on the x axis and number of occurrences on the y-axis. It indicates that overflows mainly occur when precipitation rate is above 2 mm per hour." /></p>

<p>something about whether after 9 am matters</p>

<h2>Remaining tasks</h2>

<ol>
<li><del>Get throttling events: Input throttling data from Paper API</del></li>
<li><del>Get precipitation events: Convert Weather data from JSON to CSV</del></li>
<li><del>Build algorithm to correlate throttling events with precipitation events</del></li>
<li>Refactor alert system to leverage algorithm from step 3</li>
<li>Visualize alert data (TBD)</li>
</ol>


<h2>Contributors</h2>

<ul>
<li>Leif: gathering weather data and data entry (http://github.com/lpercifield)</li>
<li>Tom: understanding the stats and data entry (http://github.com/tlevine)</li>
<li>Carl: visualization of weather data (http://github.com/c4rl)</li>
<li>Casey: data entry and calculations (http://github.com/caseytwebb)</li>
<li>Mike: data visualzation and structure in tableau (http://github.com/acceleratormt)</li>
<li>Frank: Excel expert</li>
</ul>

